--------------------------------------------------------------------------------
11:00:51 | INFO  | Running with prism v0.2.7...
11:00:51 | INFO  | Found project directory at /Users/mihirtrivedi/Documents/datastack/git/prism/prism/tests/integration/test_projects/009_simple_dbt_project/prism
 
11:00:51 | INFO  | RUNNING EVENT 'parsing prism_project.py'........................................ [RUN]
11:00:52 | ERROR | ERROR IN EVENT 'parsing prism_project.py'....................................... [ERROR in 1.49s]
 
11:00:52 | ERROR | Traceback (most recent call last):
...
...
  File "/Users/mihirtrivedi/.pyenv/versions/3.10.12/envs/prism-req-dep-test/lib/python3.10/site-packages/dbt/task/runnable.py", line 90, in __init__
    if self.args.defer_state:
AttributeError: 'InitializeDbtCompileTaskArgs' object has no attribute 'defer_state'

--------------------------------------------------------------------------------
--------------------------------------------------------------------------------
11:01:29 | INFO  | Running with prism v0.2.7...
11:01:29 | INFO  | Found project directory at /Users/mihirtrivedi/Documents/datastack/git/prism/prism/tests/integration/test_projects/009_simple_dbt_project/prism
 
11:01:29 | INFO  | RUNNING EVENT 'parsing prism_project.py'........................................ [RUN]
11:01:30 | ERROR | ERROR IN EVENT 'parsing prism_project.py'....................................... [ERROR in 1.47s]
 
11:01:30 | ERROR | Traceback (most recent call last):
  File "/Users/mihirtrivedi/Documents/datastack/git/prism/prism/event_managers/base.py", line 153, in manage_events_during_run
    outputs = self.run(**kwargs)
  File "/Users/mihirtrivedi/Documents/datastack/git/prism/prism/event_managers/base.py", line 132, in run
    return self.func(**kwargs)
  File "/Users/mihirtrivedi/Documents/datastack/git/prism/prism/mixins/base.py", line 55, in create_project
    project.setup()
  File "/Users/mihirtrivedi/Documents/datastack/git/prism/prism/infra/project.py", line 177, in setup
    self.profile.generate_adapters()
  File "/Users/mihirtrivedi/Documents/datastack/git/prism/prism/profiles/profile.py", line 240, in generate_adapters
    user_defined_adapter = MetaAdapter.get_adapter(adapter_type)(
  File "/Users/mihirtrivedi/Documents/datastack/git/prism/prism/profiles/dbt.py", line 113, in __init__
    self.compile_task = self.initialize_compile_task(
  File "/Users/mihirtrivedi/Documents/datastack/git/prism/prism/profiles/dbt.py", line 249, in initialize_compile_task
    compile_task = CompileTask(args, dbt_config, manifest)
  File "/Users/mihirtrivedi/.pyenv/versions/3.10.12/envs/prism-req-dep-test/lib/python3.10/site-packages/dbt/task/runnable.py", line 90, in __init__
    if self.args.defer_state:
AttributeError: 'InitializeDbtCompileTaskArgs' object has no attribute 'defer_state'

--------------------------------------------------------------------------------
--------------------------------------------------------------------------------
11:03:23 | INFO  | Running with prism v0.2.7...
11:03:23 | INFO  | Found project directory at /Users/mihirtrivedi/Documents/datastack/git/prism/prism/tests/integration/test_projects/009_simple_dbt_project/prism
 
11:03:23 | INFO  | RUNNING EVENT 'parsing prism_project.py'........................................ [RUN]
11:03:25 | INFO  | FINISHED EVENT 'parsing prism_project.py'....................................... [DONE in 1.60s]
11:03:25 | INFO  | RUNNING EVENT 'task DAG'........................................................ [RUN]
11:03:25 | INFO  | FINISHED EVENT 'task DAG'....................................................... [DONE in 0.01s]
11:03:25 | INFO  | RUNNING EVENT 'creating pipeline, DAG executor'................................. [RUN]
11:03:25 | INFO  | FINISHED EVENT 'creating pipeline, DAG executor'................................ [DONE in 0.01s]
 
11:03:25 | INFO  | ====================== tasks 'rose-jackrabbit-AtrTnPTm5K' ======================
11:03:25 | INFO  | 1 of 1 RUNNING EVENT 'filter_customers.FilterCustomers'......................... [RUN]
11:03:25 | ERROR | 1 of 1 ERROR IN EVENT 'filter_customers.FilterCustomers'........................ [ERROR in 0.02s]
 
11:03:25 | ERROR | Traceback (most recent call last):
  File "/Users/mihirtrivedi/Documents/datastack/git/prism/prism/event_managers/base.py", line 153, in manage_events_during_run
    outputs = self.run(**kwargs)
  File "/Users/mihirtrivedi/Documents/datastack/git/prism/prism/event_managers/base.py", line 132, in run
    return self.func(**kwargs)
  File "/Users/mihirtrivedi/Documents/datastack/git/prism/prism/infra/compiled_task.py", line 204, in exec
    run_context[task_var_name].exec()
  File "/Users/mihirtrivedi/Documents/datastack/git/prism/prism/task.py", line 83, in exec
    self.output = self.run(self.task_manager, self.hooks)
  File "/Users/mihirtrivedi/Documents/datastack/git/prism/prism/decorators/target.py", line 83, in wrapper_target_dec
    obj = func(self, task_manager, hooks)
  File filter_customers.FilterCustomers, line 23, in run
  File "/Users/mihirtrivedi/Documents/datastack/git/prism/prism/infra/hooks.py", line 134, in dbt_ref
    df = dbt_project.handle_ref(target_1, target_2, target_version)
  File "/Users/mihirtrivedi/Documents/datastack/git/prism/prism/profiles/dbt.py", line 433, in handle_ref
    target_model = self.get_parsed_task_node(
  File "/Users/mihirtrivedi/Documents/datastack/git/prism/prism/profiles/dbt.py", line 304, in get_parsed_task_node
    target_model: MaybeNonSource = manifest.resolve_ref(
TypeError: Manifest.resolve_ref() missing 1 required positional argument: 'source_node'

--------------------------------------------------------------------------------
--------------------------------------------------------------------------------
11:06:08 | INFO  | Running with prism v0.2.7...
11:06:08 | INFO  | Found project directory at /Users/mihirtrivedi/Documents/datastack/git/prism/prism/tests/integration/test_projects/009_simple_dbt_project/prism
 
11:06:08 | INFO  | RUNNING EVENT 'parsing prism_project.py'........................................ [RUN]
11:06:10 | INFO  | FINISHED EVENT 'parsing prism_project.py'....................................... [DONE in 1.60s]
11:06:10 | INFO  | RUNNING EVENT 'task DAG'........................................................ [RUN]
11:06:10 | INFO  | FINISHED EVENT 'task DAG'....................................................... [DONE in 0.01s]
11:06:10 | INFO  | RUNNING EVENT 'creating pipeline, DAG executor'................................. [RUN]
11:06:10 | INFO  | FINISHED EVENT 'creating pipeline, DAG executor'................................ [DONE in 0.01s]
 
11:06:10 | INFO  | ======================== tasks 'lovely-rook-7yWzQdaxm3' ========================
11:06:10 | INFO  | 1 of 1 RUNNING EVENT 'filter_customers.FilterCustomers'......................... [RUN]
11:06:13 | INFO  | 1 of 1 FINISHED EVENT 'filter_customers.FilterCustomers'........................ [DONE in 2.90s]
 
11:06:13 | INFO  | Done!
--------------------------------------------------------------------------------
--------------------------------------------------------------------------------
11:08:54 | INFO  | Running with prism v0.2.7...
11:08:54 | INFO  | Found project directory at /Users/mihirtrivedi/Documents/datastack/git/prism/prism/tests/integration/test_projects/009_simple_dbt_project/prism
 
11:08:54 | INFO  | RUNNING EVENT 'parsing prism_project.py'........................................ [RUN]
11:08:55 | INFO  | FINISHED EVENT 'parsing prism_project.py'....................................... [DONE in 1.61s]
11:08:55 | INFO  | RUNNING EVENT 'task DAG'........................................................ [RUN]
11:08:55 | INFO  | FINISHED EVENT 'task DAG'....................................................... [DONE in 0.01s]
11:08:55 | INFO  | RUNNING EVENT 'creating pipeline, DAG executor'................................. [RUN]
11:08:55 | INFO  | FINISHED EVENT 'creating pipeline, DAG executor'................................ [DONE in 0.01s]
 
11:08:55 | INFO  | ====================== tasks 'bouncy-sparrow-KGsoecjj82' ======================
11:08:56 | INFO  | 1 of 1 RUNNING EVENT 'filter_customers.FilterCustomers'......................... [RUN]
11:08:57 | INFO  | 1 of 1 FINISHED EVENT 'filter_customers.FilterCustomers'........................ [DONE in 1.86s]
 
11:08:57 | INFO  | Done!
--------------------------------------------------------------------------------
